#{extends 'main.html' /}
#{set title:'Twitter Mention Graph' /}

#{if !isLoggedIn}
		<div class="navbar navbar-inverse navbar-fixed-top" style="box-shadow: 0 4px 4px 4px rgba(0,0,0,0.3);">
			<div class="navbar-inner">
				<div class="container">
					<a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
			 		</a>
			 		 <a class="brand" href="#">TwiGraph</a>
					<div class="nav-collapse collapse">
						<ul class="nav">
							<li class="active"><a href="#">Home</a></li>
							<li><a href="#about">About</a></li>
							<li><a href="#contact">Contact</a></li>
						</ul>
						<a href="@{Application.login()}" class="btn btn-primary">Sign in with Twitter</a>
					</div><!--/.nav-collapse -->
				</div>
			</div>
		</div>
#{/if}

#{else}
		<div class="navbar navbar-inverse navbar-fixed-top" style="box-shadow: 0 4px 4px 4px rgba(0,0,0,0.3);">
			<div class="navbar-inner">
				<div class="container">
					<a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
			 		</a>
			 		 <a class="brand" href="#">TwiGraph</a>
					<div class="nav-collapse collapse">
						<ul class="nav">
							<li class="active"><a href="#">Home</a></li>
							<li><a href="#about">About</a></li>
							<li><a href="#contact">Contact</a></li>
						</ul>
						<a href="@{Application.logout()}" class="btn btn-primary">Logout</a>
					</div><!--/.nav-collapse -->
				</div>
			</div>
		</div>

<!--
  ${account?.userName}<br />
  ${account?.twitterId}<br />
  ${account?.profileImgUrl}<br />
  ${account?.accessToken}<br />
  ${account?.accessTokenSecret}<br />
 -->

#{/else}



		<div class="container">

			<!-- Main hero unit for a primary marketing message or call to action -->
			<div class="hero-unit"
				style="background: #fff; background-image: url(./public/images/TwG_top.png); background-position: right top; background-repeat: no-repeat;">
				<h1>TwiGraph</h1>
				<p>TwiGraphはリアルタイムにTwitter上のコミュニケーションを可視化することで、新たな体験を皆様にお届けします。</p>
				<p>
					<a class="btn btn-primary btn-large" href="@{Application.login()}">今すぐ利用する！ &raquo;</a>
				</p>
			</div>

			<div class="row">
<!--
				<div class="span12">
					<p><button id="debug" class="btn btn-inverse">Debug Menu<i class="icon-wrench icon-white"></i></button>
					</p>

					<div class="span12">
						<input type="button" class="btn btn-primary" value="外部ボタン処理テスト" onClick="test()">
					</div>

					<div class="span10" id="debugForm" style="">
						<ul class="nav nav-pills nav-stacked">
							<li class="active"><a style="background: gray;">ノード・エッジ追加テスト</a></li>
						</ul>
						<form name="addNode" class="form-inline">
							<label>新規ノード</label>
							<input id="fromNode" value="charlie_1219" class="input-medium" type=text>
							<label>接続先ノード</label>
							<input id="toNode" value="${account?.userName}" class="input-medium" type=text>
							<input type="button" class="btn btn-primary" value="addNode" onClick="test2()">
						</form>
						<ul class="nav nav-pills nav-stacked">
							<li class="active"><a style="background: gray;">ツイート追加テスト</a></li>
						</ul>
						<form name="tweetTest" class="form-inline">
							発言ユーザ：<input id="tweetUser" value="${account?.userName}" class="input-medium" type=text>
							ツイート：<input id="tweet" value="ツイートするお" type=text>
							<input type="button" class="btn btn-primary" value="addtweet" onClick="test4()">
						</form>
						<ul class="nav nav-pills nav-stacked">
							<li class="active"><a style="background: gray;">メンション追加テスト</a></li>
						</ul>
						<form name="mentionTest" class="form-inline">
							発言ユーザ：<input id="fromUser" class="input-medium" value="bojonne" type=text>
							メンション先ユーザ：<input id="toUser" class="input-medium" value="egg" type=text>
							<input type="button" class="btn btn-primary" value="addMention" onClick="test5()">
						</form>
					</div>
				</div>

				<div class="span9" style="textalign: center;">
					<canvas id="processing" datasrc="@{'/public/javascripts/graph.pjs'}" style="border: 2px solid #333333; border-radius: 0.5em; background-image: url(./public/images/bg_24_9.gif);"></canvas>
				</div>

				<div class="span3" style="">
					<div class="bar2" style="">
						<h4 class="" style="color: #ffffff; margin: 10px;">Twitter Activity</h4>
					</div>
					<div class="messagebox">
						<div class="user">ツイッターあれこれ</div>
						<div class="twit">何か動きがあったら＋</div>
					</div>
				</div>
 -->

				<div class="span12" id="about">
					<h2>Introduction</h2>
					<p>TwiGraphは、Twitterにおけるユーザー同士の関係性、コミニュケーションのやりとりを関係性グラフで表現します。</p>
				</div>
				<div class="span12">
					<h2>How to use</h2>
					<p>ご自身のTwitterアカウントでログインして頂くことで、自動的にフォロワーとの関係性を分析しグラフに反映します。</p>
					<p>TwiGraph利用中は常にツイートを取得しているため、やりとりがリアルタイムにグラフへフィードバックされます。</p>
				</div>
				<div class="span12 test">
					<h2>Technical Info</h2>
					<p>Web Application Framework: Play! Framework 1.2.5</p>
					<p>Twitter Control: Twitter4J - A Java library for the Twitter API</p>
					<p>Graph Visualization: Processing.js</p>
				</div>
				<div class="span12" id="contact">
					<h2>Contact</h2>
					<p>山名研究室 M1 奥谷 貴志 Mail:okutani@yama.info.waseda.ac.jp</p>
					<p>山名研究室 M1 駒田 康孝 Mail:ykoma@yama.info.waseda.ac.jp</p>
					<p>山名研究室 M1 鈴木 大地 Mail:dsuzuki@yama.info.waseda.ac.jp</p>
				</div>
				<!--


				-->
			</div>
			<hr>
			<footer>
				<p>山名研究室プロジェクト研究 2012</p>
			</footer>
		</div>
		<!-- /container -->

<script language="JavaScript">

			var array = [];

			$( function() {
			    $('#debug').click( function() {
			        $('#debugForm').toggle( 'blind', '', 500 );
			    } );
			} );


			function test(){
		    	var p = Processing.getInstanceById('processing');
				p.external();
			}
			function test2(){
				var p = Processing.getInstanceById('processing');
				p.exAddNode(document.addNode.fromNode.value,document.addNode.toNode.value);
			}
			function test3(){
				//alert("extGraph?--");
				var p = Processing.getInstanceById('processing');
				p.extGraph(document.extNode.oauthId.value,document.extNode.oauthId.user);
				//window.location.href = "@{Application.extendGraph(accountId,"bojonne")}";
			}
			function test4(){
				var p = Processing.getInstanceById('processing');
				//alert(document.tweetTest.tweetUser.value + " # " + document.tweetTest.tweet.value);
				p.addTweet(document.tweetTest.tweetUser.value,document.tweetTest.tweet.value);
				//window.location.href = "@{Application.extendGraph(accountId,"bojonne")}";
			}
			function test5(){
				var p = Processing.getInstanceById('processing');
				p.addTweet(document.mentionTest.fromUser.value,"メンションテスト");
				p.addMention(document.mentionTest.fromUser.value,document.mentionTest.toUser.value);
				//window.location.href = "@{Application.extendGraph(accountId,"bojonne")}";
			}


			function addNewEdge(fromN,toN,eWeight){
				var p=Processing.getInstanceById('processing');
				p.addEdge(fromN,toN,eWeight);
			}
			function addNode(name,img){
				var p=Processing.getInstanceById('processing');
				//alert(name);
				p.dxAddNode(name.toLowerCase(),img);
			}
			function exAddBalloon(userName,text){
				//alert(userName+" # "+text);
				var p=Processing.getInstanceById('processing');
				p.addTweet(userName,userName,text);
			}
			function exAddMention(fromUser,toUser){
				//alert(fromUser+" # "+toUser);
				//addTweet();
			}
			/*
			function exGraph(user){
				//alert(user);
			}
			*/
			function extendGraph(oauthId,userName){
				 var callUrl = "@{Application.extendGraph()}?oauthId=" + oauthId + "&user=" + userName
				 var req = new XMLHttpRequest();
				 req.open('GET', callUrl, true);
				 req.send(null);
			}
	</script>



